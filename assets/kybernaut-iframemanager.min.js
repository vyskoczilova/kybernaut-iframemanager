/*!
 * iframemanager v1.0
 * Author Orest Bida
 * Released under the MIT License
 */
!function(){"use strict";var e={iframes:{},preconnects:[],preloads:[],iframeObserver:null,currLang:null,services:null,serviceNames:null,_getVideoProp:function(e){return{_id:e.dataset.id,_title:e.dataset.title,thumbnail:e.dataset.thumbnail,params:e.dataset.params,thumbnailPreload:e.hasAttribute("data-thumbnailpreload"),div:e,backgroundDiv:null,hasIframe:!1,hasNotice:!1,showNotice:!0}},_lazyLoadThumnails:function(t,a){var i=this.iframes[t],n=i.length;if("IntersectionObserver"in window)for(var r=new IntersectionObserver((function(t){t.forEach((function(t){if(t.isIntersecting){var n=t.target.dataset.index;e._loadThumbnail(a,i[n]),r.unobserve(t.target)}}))})),o=0;o<n;o++)r.observe(i[o].div);else for(o=0;o<n;o++)e._loadThumbnail(a,i[o])},acceptService:function(t){if("all"===t)for(var a=this.serviceNames.length,i=0;i<a;i++){n(t=this.serviceNames[i],this.services[t])}else this.serviceNames.indexOf(t)>-1&&n(t,this.services[t]);function n(t,a){e._getCookie(a.cookie.name)||e._setCookie(a.cookie),e._hideAllNotices(t,a)}},rejectService:function(t){if("all"===t){this.iframeObserver=null;for(var a=this.serviceNames.length,i=0;i<a;i++){n(t=this.serviceNames[i],this.services[t])}}else this.serviceNames.indexOf(t)>-1&&n(t,this.services[t]);function n(t,a){e._getCookie(a.cookie.name)&&e._eraseCookie(a.cookie),e._showAllNotices(t,a)}},_loadThumbnail:function(t,a){if("string"==typeof a.thumbnail)a.thumbnailPreload&&this._thumbnailPreload(a.thumbnail),""!==a.thumbnail&&n(a.thumbnail);else if("function"==typeof t)t(a._id,(function(t){e._preconnect(t),a.thumbnailPreload&&this._thumbnailPreload(t),n(t)}));else if("string"==typeof t){var i=t.replace("{data-id}",a._id);this._preconnect(i),a.thumbnailPreload&&this._thumbnailPreload(i),n(i)}function n(e){a.backgroundDiv.style.backgroundImage="url('"+e+"')";var t=new Image;t.onload=function(){a.backgroundDiv.classList.add("loaded")},t.src=e}},_createIframe:function(e,t){if(!e.hasIframe){e.iframe=this._createNode("iframe");var a=e.params||t.iframe&&t.iframe.params,i=t.embedUrl.replace("{data-id}",e._id);e.iframe.loading="lazy",e._title&&(e.iframe.title=e._title),t.iframe&&t.iframe.allow&&(e.iframe.allow=t.iframe.allow),a&&("ap:"===a.substring(0,3)?i+=a.substring(3):i+="?"+a),e.iframe.src=encodeURI(i),e.iframe.onload=function(){e.div.classList.add("c-h-b"),e.iframe.onload=void 0,t.iframe&&"function"==typeof t.iframe.onload&&t.iframe.onload(e._id,this)},e.hasIframe=!0,e.div.appendChild(e.iframe)}},_removeIframe:function(e){e.iframe.parentNode.removeChild(e.iframe),e.hasIframe=!1},_hideNotice:function(e){e.showNotice&&(e.div.classList.add("c-h-n"),e.showNotice=!1)},_showNotice:function(e){e.showNotice||(e.div.classList.remove("c-h-n","c-h-b"),e.showNotice=!0)},_getCookie:function(e){return(e=document.cookie.match("(^|;)\\s*"+e+"\\s*=\\s*([^;]+)"))?e.pop():""},_setCookie:function(e){var t=new Date,a=e.path||"/",i=e.expiration||182,n=e.sameSite||"Lax",r=e.domain||location.hostname;t.setTime(t.getTime()+24*i*60*60*1e3);var o=" expires="+t.toUTCString(),s=e.name+"=1;"+o+"; Path="+a+";";s+=" SameSite="+n+";",r.indexOf(".")>-1&&(s+=" Domain="+r+";"),"https:"===location.protocol&&(s+=" Secure;"),document.cookie=s},_eraseCookie:function(e){var t=e.path||"/",a=e.domain||location.hostname;document.cookie=e.name+"=; Path="+t+"; Domain="+a+"; Expires=Thu, 01 Jan 1970 00:00:01 GMT;"},_getKeys:function(e){if("object"==typeof e){var t=[],a=0;for(t[a++]in e);return t}},_preconnect:function(e){var t=(e=e.split("://"))[0];if("http"==t||"https"==t){var a=e[1]&&e[1].split("/")[0]||!1;if(a&&a!==location.hostname&&-1===this.preconnects.indexOf(a)){var i=this._createNode("link");i.rel="preconnect",i.href=t+"://"+a,document.head.appendChild(i),this.preconnects.push(a)}}},_thumbnailPreload:function(e){if(e&&-1===this.preloads.indexOf(e)){var t=this._createNode("link");t.rel="preload",t.as="image",t.href=e,document.head.appendChild(t),this.preloads.push(e)}},_createNode:function(e){return document.createElement(e)},_createAllNotices:function(t,a,i){for(var n=this.iframes[t],r=n.length,o=0;o<r;o++)!function(r){var o=n[r];if(!o.hasNotice){var s=a.languages[e.currLang].loadBtn,c=a.languages[e.currLang].notice,l=a.languages[e.currLang].loadAllBtn,d=document.createDocumentFragment(),h=e._createNode("div"),m=e._createNode("span"),u=e._createNode("p"),f=e._createNode("button"),p=e._createNode("button"),v=e._createNode("span"),g=e._createNode("div"),_=e._createNode("div"),b=e._createNode("div"),N=e._createNode("div"),w=e._createNode("div");f.type=p.type="button",v.className="cc-text",f.type=p.type="button",v.className="cc-text",b.className="c-bg-i",o.backgroundDiv=b,_.className="c-ld","string"==typeof o.thumbnail&&""===o.thumbnail||(g.className="c-bg");var L=o._title,y=document.createDocumentFragment();if(L){var C=e._createNode("span");C.className="c-tl",C.insertAdjacentHTML("beforeend",L),y.appendChild(C)}function k(){e._hideNotice(o),e._createIframe(o,a)}f.textContent=s,p.textContent=l,v.appendChild(y),h&&v.insertAdjacentHTML("beforeend",c||""),m.appendChild(v),N.className="c-t-cn",m.className="c-n-t",u.className="c-n-c",h.className="c-nt",w.className="c-n-a",f.className="c-l-b",p.className="c-la-b",w.appendChild(f),w.appendChild(p),N.appendChild(m),N.appendChild(w),u.appendChild(N),h.appendChild(u),f.addEventListener("click",(function(){k()})),p.addEventListener("click",(function(){k(),e.acceptService(t)})),g.appendChild(b),d.appendChild(h),(a.thumbnailUrl||o.thumbnail)&&d.appendChild(g),d.appendChild(_),i&&o.div.classList.add("c-h-n"),o.div.appendChild(d),o.hasNotice=!0}}(o)},_hideAllNotices:function(t,a){var i,n=this.iframes[t],r=n.length;if("IntersectionObserver"in window){this.iframeObserver=new IntersectionObserver((function(t){for(var i=0;i<t.length;++i){if(null===e.iframeObserver)return;t[i].isIntersecting&&function(i){setTimeout((function(){var r=t[i].target.dataset.index;e._createIframe(n[r],a),e._hideNotice(n[r])}),50*i),e.iframeObserver.unobserve(t[i].target)}(i)}}));for(var o=0;o<r;o++)n[o].hasIframe||this.iframeObserver.observe(n[o].div)}else for(o=0;o<r;o++)i=o,e._createIframe(n[o],a),e._hideNotice(n[i])},_showAllNotices:function(t,a){for(var i,n=this.iframes[t],r=n.length,o=0;o<r;o++)i=o,n[o].showNotice||(n[o].hasIframe&&e._removeIframe(n[o]),e._showNotice(n[i]))},_getValidatedLanguage:function(e,t){return t.hasOwnProperty(e)?e:this._getKeys(t).length>0?t.hasOwnProperty(this.currLang)?this.currLang:this._getKeys(t)[0]:void 0},_getBrowserLang:function(){var e=navigator.language||navigator.browserLanguage;return e.length>2&&(e=e[0]+e[1]),e.toLowerCase()},run:function(e){var t=e.services;this.services=t;var a=this._getKeys(t);this.serviceNames=a;var i=a.length;if(0!==i){this.currLang=e.currLang;var n=t[a[0]].languages;!0===e.autoLang?this.currLang=this._getValidatedLanguage(this._getBrowserLang(),n):"string"==typeof e.currLang&&(this.currLang=this._getValidatedLanguage(e.currLang,n));for(var r=0;r<i;r++){var o=a[r];this.iframes[o]=[];var s=document.querySelectorAll('div[data-service="'+o+'"]'),c=s.length;if(0!==c){for(var l=0;l<c;l++)s[l].dataset.index=l,this.iframes[o].push(this._getVideoProp(s[l]));var d=t[o],h=d.cookie.name;this._getCookie(h)?(this._createAllNotices(o,d,!0),this._hideAllNotices(o,d)):this._createAllNotices(o,d,!1),this._lazyLoadThumnails(o,d.thumbnailUrl)}}}}},t="iframemanager";window[t]=function(){return window[t]=void 0,e}}(),window.addEventListener("load",(function(){iframemanager().run({currLang:"x",services:{youtube:{embedUrl:"https://www.youtube-nocookie.com/embed/{data-id}",thumbnailUrl:"https://i3.ytimg.com/vi/{data-id}/hqdefault.jpg",iframe:{allow:"accelerometer; encrypted-media; gyroscope; picture-in-picture; fullscreen;"},cookie:{name:"cc_youtube"},languages:{x:{notice:props.l10n_notice.replace("SITE","youtube.com").replace("3PARTYURL","https://www.youtube.com/t/terms"),loadBtn:props.l10n_loadBtn,loadAllBtn:props.l10n_loadAllBtn}}},vimeo:{embedUrl:"https://player.vimeo.com/video/{data-id}",thumbnailUrl:function(e,t){var a="https://vimeo.com/api/v2/video/"+e+".json",i=new XMLHttpRequest;i.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var e=JSON.parse(this.response)[0].thumbnail_large;t(e)}},i.open("GET",a,!0),i.send()},iframe:{allow:"accelerometer; encrypted-media; gyroscope; picture-in-picture; fullscreen;"},cookie:{name:"cc_vimeo"},languages:{x:{notice:props.l10n_notice.replace("SITE","vimeo.com").replace("3PARTYURL","https://vimeo.com/terms"),loadBtn:props.l10n_loadBtn,loadAllBtn:props.l10n_loadAllBtn}}}}})}));
